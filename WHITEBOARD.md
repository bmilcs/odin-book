# Project Whiteboard

**TODO**

- FIX postController
  - Allow multiple likes on posts/comments if user is unique
- Toast window
  - Errors, etc.
- User Profile Pages
  - Username
  - Email
  - Bio

## Requirements

- Users
  - authentication: jwt
  - create posts
  - like posts
  - comment posts
  - friend requests
    - send/receive
    - users must accept request to become friends
  - profile
    - photo
    - basic details
- Posts
  - content
  - author
  - comments
  - likes
- Posts Index Page
  - display all recent posts
    - current user
    - friends
- User show page
  - profile info
  - profile photo
  - posts
- Users index page
  - list all users
  - friend request buttons: for non-friends / no existing pending requests

## Data Models

### User

- \_id (Auto-generated by MongoDB)
- username (User's name)
- email (User's email address)
- password (Hashed password for authentication)
- photo (URL to the user's photo)
- profile (An object containing basic user details)
  - bio
  - location
- friends (An array of user IDs representing friends)
- friendRequestsSent (An array of user IDs for pending friend requests sent)
- friendRequestsReceived (An array of user IDs for pending friend requests received)

### Posts

- \_id (Auto-generated by MongoDB)
- content (Content of the post)
- author (Reference to the User who created the post)
- comments (An array of comment objects)
- likes (An array of user IDs who liked the post)

### Comments

- \_id (Auto-generated by MongoDB)
- text (The content of the comment)
- author (Reference to the User who wrote the comment)
- post (Reference to the Post to which the comment is associated)

### Likes

- \_id (Auto-generated by MongoDB)
- user (Reference to the User who liked the post or comment)
- post (Reference to the Post that was liked, optional)
- comment (Reference to the Comment that was liked, optional)

## Routes

Authentication:

- Sign Up: POST /api/auth/signup
- Log In: POST /api/auth/login
- Log Out: POST /api/auth/logout

User Profiles:

- View Profile: GET /api/users/{userID}
- Update Profile: PATCH /api/users/{userID}

Friends:

- Send Friend Request: POST /api/friends/send-request
- Accept Friend Request: PATCH /api/friends/accept-request/{requestID}
- Reject Friend Request: PATCH /api/friends/reject-request/{requestID}
- Unfriend: DELETE /api/friends/{friendID}

Posts:

- Create Post: POST /api/posts
- View Post: GET /api/posts/{postID}
- Update Post: PATCH /api/posts/{postID}
- Delete Post: DELETE /api/posts/{postID}
- Like Post: POST /api/posts/{postID}/like
- Unlike Post: DELETE /api/posts/{postID}/unlike
- Comment on Post: POST /api/posts/{postID}/comments
- Edit Comment: PATCH /api/posts/{postID}/comments/{commentID}
- Delete Comment: DELETE /api/posts/{postID}/comments/{commentID}

Feed:

- View Feed: GET /api/feed

Search:

- Search Users: GET /api/search/users

Notifications:

- View Notifications: GET /api/notifications
- Mark Notification Read: PATCH /api/notifications/{notificationID}
- Clear Notifications: DELETE /api/notifications

Messaging:

- Send Message: POST /api/messages/send
- View Messages: GET /api/messages/{conversationID}
- Delete Message: DELETE /api/messages/{messageID}
- Create Conversation: POST /api/messages/create-conversation

## API Response Standardization

```ts
interface ApiResponse {
  success: boolean;
  message: string;
  data?: any;
  error?: any;
}
```

## Client: Like Handling

- Comments & Posts are rendered via Feed component
- Feed = array of posts (with likes ie: user refs), with nested comments (with likes ie: user refs)

```ts
const postSchema: Schema = new Schema(
  {
    content: { type: String, required: true, maxlength: 1000 },
    author: { type: mongoose.Types.ObjectId, ref: "User", required: true },
    comments: [{ type: mongoose.Types.ObjectId, ref: "Comment" }],
    likes: [{ type: mongoose.Types.ObjectId, ref: "Like" }],
  },
  { timestamps: true }, // auto create 'createdAt' and 'updatedAt' fields
);

const CommentSchema: Schema = new Schema(
  {
    content: { type: String, required: true, maxlength: 1000 },
    author: { type: Schema.Types.ObjectId, ref: "User", required: true },
    post: { type: Schema.Types.ObjectId, ref: "Post", required: true },
  },
  { timestamps: true }, // auto create 'createdAt' and 'updatedAt' fields
);

const likeSchema: Schema = new Schema(
  {
    user: { type: Schema.Types.ObjectId, ref: "User", required: true },
    post: { type: Schema.Types.ObjectId, ref: "Post" },
    comment: { type: Schema.Types.ObjectId, ref: "Comment" },
  },
  { timestamps: true }, // auto create 'createdAt' and 'updatedAt' fields
);
```

`LikeButton` component parameters / requirements:

- contentType: 'comment' | 'post'
- \_id: associated w/ the above type
- current state: boolean

`LikeButton` functionality:

- click toggle: via custom `useLike` hook
- issue fetch requests to server, wait for response, toggle like state
- disable clicking again until complete
